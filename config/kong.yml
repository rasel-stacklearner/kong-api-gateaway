# For more about Basic Authorization plugin : https://docs.konghq.com/hub/kong-inc/basic-auth/3.0.x/

_format_version: "2.1"


services:
  - name: echo-server
    host: host.docker.internal
    port: 4000
    path: /echo
    routes:
      - name: localhost_echo_route
        paths:
        - /echo_server
        - /echo_server2
  - name: remote_server
    host: host.docker.internal
    port: 4000
    path: /remote
    routes:
     - name: localhost_remote_routee
       paths:
        - /remote_server
        - /remote_server2


# step 1:  Create consumer in Kong.
consumers:
  - username: rasel

# step 2: create Basic Credentials
basicauth_credentials:
- consumer: rasel 
  username: Aladdin
  password: OpenSesame

# step 3: Enable Basic Auth plugins
plugins:
- name: basic-auth
  config:
    hide_credentials: true


#  The user name and password will be encoded with Base64 and passed in the Authorization header.

# Request with curl 
# curl -H "Authorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l" http://localhost:8000/echo_server