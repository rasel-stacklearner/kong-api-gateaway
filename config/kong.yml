# For more about ratelimiting plugin : https://docs.konghq.com/hub/kong-inc/bot-detection/how-to/basic-example/

# populer user aggent : https://github.com/Kong/kong/blob/master/kong/plugins/bot-detection/rules.lua

_format_version: "3.0"
_transform: true


services:
  - name: echo-server
    host: host.docker.internal
    port: 4000
    path: /echo
    routes:
      - name: localhost_echo_route
        paths:
        - /echo_server
        - /echo_server2
  - name: remote_server
    host: host.docker.internal
    port: 4000
    path: /remote
    routes:
     - name: localhost_remote_routee
       paths:
        - /remote_server
        - /remote_server2

# plugins
plugins:
- name: proxy-cache
  config:
    response_code:
    - 200
    request_method:
    - GET
    - HEAD
    content_type:
    - text/plain
    - application/json
    - application/json; charset=utf-8
    - text/plain; charset=utf-8
    cache_ttl: 300
    strategy: memory



# - name: proxy-cache
#     config: 
#       response_code
#       - 200
#       - 301
#       - 404
#       request_method:
#       - GET
#       - HEAD
#       content_type:
#       - text/plain
#       - application/json
#       - application/json; charset=utf-8
#       - text/plain; charset=utf-8
#       cache_ttl: 300
#       strategy: memory
#       cache_control: true
#       memory:
#         dictionary_name: kong_db_cache
